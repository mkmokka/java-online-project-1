<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Login & Registration</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js"></script>
</head>
<body>
<h2>Login</h2>
<input type="email" id="email" placeholder="Email">
<input type="password" id="password" placeholder="Password">
<button onclick="login()">Login</button>

<h2>Register</h2>
<input type="email" id="regEmail" placeholder="Email">
<input type="password" id="regPassword" placeholder="Password">
<button onclick="register()">Register</button>

<script>
  const firebaseConfig = {
     apiKey: "AIzaSyC4cBrRY0KHGE0oQ44wSrActgvb8DdhsPY",
  authDomain: "game-aa019.firebaseapp.com",
  databaseURL: "https://game-aa019-default-rtdb.firebaseio.com",
  projectId: "game-aa019",
  storageBucket: "game-aa019.firebasestorage.app",
  messagingSenderId: "116494842335",
  appId: "1:116494842335:web:fb2fe00b737b31ee23ec6a",
  measurementId: "G-Y1YVEZY7CN"
  };
  const app = firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();

  // LOGIN
  function login() {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;

    auth.signInWithEmailAndPassword(email, password)
        .then(userCredential => userCredential.user.getIdToken())
        .then(idToken => {
          fetch('/login', {
            method: 'POST',
            headers: {'Content-Type': 'application/x-www-form-urlencoded'},
            body: 'idToken=' + idToken
          }).then(res => window.location.href='/dashboard');
        })
        .catch(err => alert(err.message));
  }

  // REGISTER
  function register() {
    const email = document.getElementById("regEmail").value;
    const password = document.getElementById("regPassword").value;

    auth.createUserWithEmailAndPassword(email, password)
        .then(userCredential => {
            alert("Registration successful! Wait for admin approval.");
        })
        .catch(error => alert(error.message));
  }
</script>
</body>
</html>
